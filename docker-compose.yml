services:
  minecraft:
    container_name: mc-fabric
    image: itzg/minecraft-server:latest
    deploy:
      resources:
        limits:
          cpus: "2"
    ports:
      - "25565:25565" # Java
      - "19132:19132/udp" # Bedrock
      - "24454:24454" # Simple Voice Chat
    environment:
      EULA: "TRUE"
      TYPE: FABRIC
      VERSION: 1.21.8
      ONLINE_MODE: "FALSE"
      MEMORY: 2G
      ENABLE_RCON: "true"
      VANILLATWEAKS_SHARECODE: "a44lHY,znojXy"
      DIFFICULTY: hard
      GAMEMODE: survival
      MOTD: "                   \u00A7afrogs\u00A7r.rocks"
      VIEW_DISTANCE: 8
      SIMULATION_DISTANCE: 8
      SPAWN_PROTECTION: 0
      USE_MEOWICE_FLAGS: "true"
      RCON_CMDS_STARTUP: |
        /gamerule mobExplosionGriefing false
        /op yolona_oss
        /op Ligul
        /op .AnxiousYapper99
        /op Andsay
      SYNC_SKIP_NEWER_IN_DESTINATION: "true"
      MODS_FILE: /extras/mods.txt
      SEED: "5876406785389981493"
    volumes:
      - ./mc-data:/data
    configs:
      - source: youritemsaresafe
        target: /config/youritemsaresafe.json5
      - source: mods
        target: /extras/mods.txt
    restart: unless-stopped

configs:
  mods:
    content: |
      #
      # libs
      #
      https://cdn.modrinth.com/data/P7dR8mSH/versions/CF23l2iP/fabric-api-0.133.4%2B1.21.8.jar
      # for youritemsaresafe
      https://cdn.modrinth.com/data/e0M1UDsY/versions/mld0ZPD9/collective-1.21.8-8.4.jar
      #
      # optimisations
      #
      https://cdn.modrinth.com/data/uXXizFIs/versions/CtMpt7Jr/ferritecore-8.0.0-fabric.jar
      https://cdn.modrinth.com/data/gvQqBUqZ/versions/pDfTqezk/lithium-fabric-0.18.0%2Bmc1.21.8.jar
      https://cdn.modrinth.com/data/fQEb0iXm/versions/neW85eWt/krypton-0.2.9.jar
      https://cdn.modrinth.com/data/VSNURh3q/versions/tlZRTK1v/c2me-fabric-mc1.21.8-0.3.4.0.0.jar
      https://cdn.modrinth.com/data/Ps1zyz6x/versions/Bi5i8Ema/ScalableLux-0.1.5.1%2Bfabric.abdeefa-all.jar
      https://cdn.modrinth.com/data/4WWQxlQP/versions/CdJJdZ39/servercore-fabric-1.5.14%2B1.21.8.jar
      #
      # misc
      #
      https://cdn.modrinth.com/data/9eGKb6K1/versions/iGd9Wjlq/voicechat-fabric-1.21.8-2.5.35.jar
      https://cdn.modrinth.com/data/l9H9JPmo/versions/MJSMiJds/mob_explosion_griefing-1.5.0%2B1.21.3-1.21.8.jar
      https://cdn.modrinth.com/data/ghrZDhGW/versions/T88D7KI1/skinrestorer-2.4.3%2B1.21.6-fabric.jar
      https://cdn.modrinth.com/data/PExmWQV8/versions/Bu1RM4Ll/mods-command-mc1.21.8-1.1.11.jar
      https://cdn.modrinth.com/data/cUhi3iB2/versions/w0oIAEFo/tabtps-fabric-mc1.21.8-1.3.28.jar
      https://cdn.modrinth.com/data/1vkzEZjE/versions/aj90vTX9/forgivingvoid-forge-1.21.8-21.8.1.jar
      https://cdn.modrinth.com/data/13RpG7dA/versions/bJYNHoyD/image2map-0.10.1%2B1.21.6.jar
      https://cdn.modrinth.com/data/lL35xmSR/versions/m5qYhEeg/youritemsaresafe-1.21.8-4.7.jar
      #
      # bedrock
      #
      https://cdn.modrinth.com/data/wKkoqHrH/versions/Q7am23V6/geyser-fabric-Geyser-Fabric-2.8.3-b939.jar
  youritemsaresafe:
    content: |
      {
              // Whether materials are needed for the chest which spawns on death. This can be the actual chest or the costs in raw materials.
              "needChestMaterials": false,
              // Whether materials are needed for the armor stand to spawn on death. This can be the actual armor stand or the costs in raw materials.
              "needArmorStandMaterials": false,
              // Whether materials are needed for the creation of the sign when 'createSignWithPlayerName' is enabled.
              "needSignMaterials": false,
      }
